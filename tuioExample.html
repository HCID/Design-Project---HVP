<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 5.0//EN">
<html>
	<head>
		<script type="text/javascript" src="d3.v3/d3.v3.min.js"></script>

			    <script src="jquery-1.7.2.js"></script>
	    <script src="lodash.js"></script>
	    <script src="socket.io.js"></script>
	    <link href="css/chi.css" type="text/css" rel="stylesheet" />

	    <script>
	      $(document).ready(function() {
	        $(".size_button").on("click", function() {
	          if (parseInt($(this).data("size")) === 16) {
	            sixteenFuntion();
	          } else if (parseInt($(this).data("size")) === 4) {
	            fourFuntion();
	          } else if (parseInt($(this).data("size")) === 2) {
	            twoFuntion();
	          } else {
	          	schedule();
	          }
	        });
	      });
	    </script>

		<script type="text/javascript" src="Tuio.min.js"></script>


    <script>
    var data = [];
    d3.json('data/data.json', function (importedData) {
      data = importedData;
    });
    
    </script>

		<script>
			var client = new Tuio.Client({
			    host: "http://localhost:5000"
			}),

			onAddTuioCursor = function(addCursor) {
			  console.log(addCursor);
			},

			onUpdateTuioCursor = function(updateCursor) {
			  console.log(updateCursor);
			},

			onRemoveTuioCursor = function(removeCursor) {
			  console.log(removeCursor);
			},

			onAddTuioObject = function(addObject) {
			    console.log(addObject);
			},

			onUpdateTuioObject = function(updateObject) {
			    console.log(updateObject);
			},

			onRemoveTuioObject = function(removeObject) {
			    console.log(removeObject);
			},

			onRefresh = function(time) {
			  console.log(time);
			};

			client.on("addTuioCursor", onAddTuioCursor);
			client.on("updateTuioCursor", onUpdateTuioCursor);
			client.on("removeTuioCursor", onRemoveTuioCursor);
			client.on("addTuioObject", onAddTuioObject);
			client.on("updateTuioObject", onUpdateTuioObject);
			client.on("removeTuioObject", onRemoveTuioObject);
			client.on("refresh", onRefresh);
			client.connect();
		</script>

		<script>

		// var maxRadius = 100;
		// var idvalue = function (d) { return d._id};
		// var rScale = d3.scale.sqrt().range([0, maxRadius]);
		// var rValue = function (d){
		// 	return parseInt(d.event.bookmarks);
		// }

		var height = 1000,
			width = 1000;
		// 	minCollisionRadius = 12,
		// 	maxDomainValue = d3.max(data, function(d) {
	 //         	return rValue(d);
	 //        });

		// rScale.domain([0, maxDomainValue]);
	      
	 // 	data.forEach(function(d, i) {
	 //        d.forceR = Math.max(minCollisionRadius, rScale(rValue(d)));
	 //    });

		var fill = d3.scale.category20();
		var circleSelection;
		var force = d3
						.layout
						.force()
						.gravity(0.1)
						//.distance(300)
						.charge(function (d) { return -(100)} )
						// .charge(-100)
						.size([height,width])				
						.start();
		


		force.on("tick", function(e) {

		  // Push different nodes in different directions for clustering.
		  var k = 10 * e.alpha;
		  console.log("e "+e);
		  console.log("k "+k);

		  
		  // d3.select("#our_id").selectAll("g").each(function(o){
		  // 	console.log("hohoho", o);
		  // });


		  d3.select("#our_id").selectAll("g").each(function(o, i) {

		    var bit = (i % 2);

		    if (bit == 0) { 
		      o.x += k;
		      o.y += k;
		    } else {
		      o.x -= k;
		      o.y -= k;
		    }  
		     console.log ("o " + o);
		     console.log ("o.name " + o.name);
		     console.log ("o.x " + o.x);
		     console.log ("o.y " + o.y);
		     console.log ("i " + i);
		  });

		  circleSelection.attr("cx", function(d) { return d.x; })
		      .attr("cy", function(d) { return d.y; })
		      .call(force.drag);

		  // vis.selectAll("path")
		  // 	.remove();

		  // vis.selectAll("path")
		  //   .data(groups)
		  //     .attr("d", groupPath)
		  //   .enter().insert("path", "circle")
		  //     .style("fill", groupFill)
		  //     .style("stroke", groupFill)
		  //     .style("stroke-width", 40)
		  //     .style("stroke-linejoin", "round")
		  //     .style("opacity", .2)
		  //     .attr("d", groupPath)
		  //     .on("click", function(d) {
		  //         return selectionPath(d);
		  //     });
		});

		function yay () {

			var data = [
			{
			   "event":{
			      "id":"123",
			      "name":"Hjejhejhje",
			      "session":{
			         "name":"asdasd",
			         "id":"2313"
			      },
			      "authors":[
			         {
			            "Author name":"Harrison Ford"
			         },
			         {
			            "Second Author":"Morgan Freeman"
			         }
			      ],
			      "place":"room1",
			      "startTime":"2001 12:21",
			      "endTime":"2002 2:12",
			      "bookmarks":123,
			      "prize":[
			         {

			         }
			      ],
			      "type":2,
			      "keywords":[
			         "hci",
			         "getures"
			      ],
			      "communities":[
			         "3rd world",
			         "design"
			      ],
			      "links":[
			         1,
			         2,
			         3
			      ],
			      "video":"chi0108-file5.mp4",
			      "papers":[
			         "paper 1"
			      ],
			      "abstract":"Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto",
			      "shortAbstract":"Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto"
			   }},
			   {"event":{
			      "id":"124",
			      "name":"Sarandonga",
			      "session":{
			         "name":"gaming",
			         "id":"3921"
			      },
			      "authors":[
			         {
			            "Author name":"Paco de Lucia"
			         },
			         {
			            "Second Author":"Camarón de la Isla"
			         }
			      ],
			      "place":"room2",
			      "startTime":"2001 12:21",
			      "endTime":"2002 2:12",
			      "bookmarks":20,
			      "prize":[
			         {

			         }
			      ],
			      "type":2,
			      "keywords":[
			         "viz",
			         "musica"
			      ],
			      "communities":[
			         "3rd world",
			         "design"
			      ],
			      "links":[
			         1,
			         2,
			         3
			      ],
			      "video":"chi0114-file5.mp4",
			      "papers":[
			         "Playing guitar for visualizing data on the air."
			      ],
			      "abstract":"Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto",
			      "shortAbstract":"Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto"
			   }
			}, 
			{"event":{
			      "id":"125",
			      "name":"Kuchi kuchi",
			      "session":{
			         "name":"fun",
			         "id":"3934"
			      },
			      "authors":[
			         {
			            "Author name":"Joaquin Sabina"
			         },
			         {
			            "Second Author":"Fito"
			         }
			      ],
			      "place":"room4",
			      "startTime":"2001 12:21",
			      "endTime":"2002 2:12",
			      "bookmarks":100,
			      "prize":[
			         {

			         }
			      ],
			      "type":2,
			      "keywords":[
			         "viz",
			         "musica"
			      ],
			      "communities":[
			         "3rd world",
			         "design"
			      ],
			      "links":[
			         1,
			         2,
			         3
			      ],
			      "video":"chi0114-file5.mp4",
			      "papers":[
			         "Playing guitar for visualizing data on the air."
			      ],
			      "abstract":"Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto",
			      "shortAbstract":"Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto"
			   }
			},
			{"event":{
			      "id":"134",
			      "name":"Marvel",
			      "session":{
			         "name":"comic",
			         "id":"3921"
			      },
			      "authors":[
			         {
			            "Author name":"Spiderman"
			         },
			         {
			            "Second Author":"Thor"
			         }
			      ],
			      "place":"room6",
			      "startTime":"2001 12:21",
			      "endTime":"2002 2:12",
			      "bookmarks":39,
			      "prize":[
			         {

			         }
			      ],
			      "type":2,
			      "keywords":[
			         "viz",
			         "musica"
			      ],
			      "communities":[
			         "3rd world",
			         "design"
			      ],
			      "links":[
			         1,
			         2,
			         3
			      ],
			      "video":"chi0114-file5.mp4",
			      "papers":[
			         "Playing guitar for visualizing data on the air."
			      ],
			      "abstract":"Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto",
			      "shortAbstract":"Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto"
			   }
			}];

			force.nodes(data).start();
// (force.nodes(), function (d) {return idvalue(d);})
			circleSelection = d3.select("#our_id").selectAll("g").data(data)
				.enter().append("g")
					.attr("id", function(d, i){return i;})
				.append("circle")
					.attr("r", function (d) {
						console.log(d);
						return d.event.bookmarks;})
					.style("fill", function (d, i) {
						return fill(i);})
					.style("stroke-width", 2)
					.style("stroke", function(d, i) { return d3.rgb(fill(i)).darker(2); })
					.call(force.drag);
	                    
			circleSelection.exit().remove();

		}

		
		


		</script>
	</head>
	<body onload="yay()">
		<button class="size_button" data-size="16">Map</button>
	    <button class="size_button" data-size="4">Author</button>
	    <button class="size_button" data-size="2">Keyword</button>
	    <button class="size_button" data-size="0">Schedule</button>
		<script>
			d3.select("body").transition().style("background-color", "black");
		</script>

		<svg id="our_id" width="1000" height="1000">
		
					
			
		</svg>
		<script>

			/*
			(function() {
			  var svg = d3.select("#chart-3").append("svg")
			      .attr("width", w)
			      .attr("height", h);

			  var circle = svg.selectAll(".little")
			      .data(data)
			    .enter().append("circle")
			      .attr("class", "little")
			      .attr("cx", x)
			      .attr("cy", y)
			      .attr("r", 12);

			  d3.select("#chart-3 button").on("click", function() {
			    circle.style("fill", "#aaa").attr("r", 12).attr("cy", y);
			    circle.transition().duration(500).delay(0).style("fill", "steelblue");
			    circle.transition().duration(500).delay(500).attr("cy", 90);
			    circle.transition().duration(500).delay(1000).attr("r", 30);
			  });
			})();
*/

		</script>

	</body>
</html>